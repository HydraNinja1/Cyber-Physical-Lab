See branches for relevant code/files
